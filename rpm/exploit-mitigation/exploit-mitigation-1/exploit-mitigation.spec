Name:		exploit-mitigation
Version:	1
Release:	1%{?dist}
Summary:	FGI exploit mitigation package

Group:		system/security
License:	GPL
URL:		http://pulse.fgi.csc.fi/
Source0:	exploit-mitigation-%{version}.tar.gz
BuildRoot:	%(mktemp -ud %{_tmppath}/%{name}-%{version}-%{release}-XXXXXX)
BuildArch:	noarch

Requires:	systemtap-client	

%description
FGI exploit mitigation package

%prep
%setup -q


%build
%configure
#make %{?_smp_mflags}


%install
rm -rf %{buildroot}
#make install DESTDIR=%{buildroot}
mkdir -p %{buildroot}/usr/share/systemtap/tapset/fgi
mkdir -p %{buildroot}/etc/init.d/
cp mitigation1.stp %{buildroot}/usr/share/systemtap/tapset/fgi
cp exploit-mitigation %{buildroot}/etc/init.d/



%clean
rm -rf %{buildroot}


%files
%defattr(-,root,root,-)
/etc/init.d/exploit-mitigation
/usr/share/systemtap/tapset/fgi/mitigation1.stp
%doc

%post
/sbin/chkconfig --add exploit-mitigation
/sbin/chkconfig exploit-mitigation on
service exploit-mitigation start

%preun
/sbin/chkconfig --del exploit-mitigation


%changelog
* Wed May 15 2013 Ulf Tigerstedt <ulf.tigerstedt@csc.fi> 1-1
  - First release with one exploit mitigated
